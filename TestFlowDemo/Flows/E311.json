{
  "Model": "E311",
  "TestSteps": [
    {
      "Name": "power_on",
      "Description": "上电",
      "Device": "power_supply_1",
      "Command": "set_voltage",
      "Parameters": { "voltage": 12.0 },
      "ExpectedResults": {
        "mode": "equals",
        "key": "status",
        "value": "ok"
      },
      "TimeoutMs": 2000,
      "DependsOn": [],
      "OnSuccess": "mydriver_demo",
      "OnFailure": "power_off"
    },
    {
      "Name": "mydriver_demo",
      "Description": "插件设备示例步骤",
      "Device": "my_driver_1",
      "Command": "demo",
      "Parameters": { },
      "ExpectedResults": { "mode": "exists", "key": "status" },
      "TimeoutMs": 1000,
      "DependsOn": [ "power_on" ],
      "OnSuccess": "ecu_can_check_ref",
      "OnFailure": "power_off"
    },
    {
      "Name": "ecu_can_check_ref",
      "Type": "SubFlowRef",
      "Ref": "ecu_can_check",
      "Description": "CAN 报文测试",
      "DependsOn": [ "power_on" ],
      "OnSuccess": "ecu_iv_check_ref",
      "OnFailure": "power_off"
    },
    {
      "Name": "ecu_iv_check_ref",
      "Type": "SubFlowRef",
      "Ref": "ecu_iv_check",
      "Description": "电流电阻联动检查",
      "DependsOn": [ "ecu_can_check_ref" ],
      "OnSuccess": "power_off",
      "OnFailure": "power_off"
    },
    {
      "Name": "power_off",
      "Description": "下电",
      "Device": "power_supply_1",
      "Command": "set_voltage",
      "Parameters": { "voltage": 0.0 },
      "ExpectedResults": {
        "mode": "equals",
        "key": "status",
        "value": "ok"
      },
      "TimeoutMs": 2000,
      "DependsOn": [ "ecu_iv_check_ref" ],
      "OnSuccess": "generate_report",
      "OnFailure": "generate_report"
    },
    {
      "Name": "generate_report",
      "Description": "生成报告",
      "Device": "report_generator",
      "Command": "generate",
      "Parameters": { "format": "html" },
      "ExpectedResults": {},
      "TimeoutMs": 2000,
      "DependsOn": [ "power_off" ],
      "OnSuccess": "end_test",
      "OnFailure": "end_test"
    },
    {
      "Name": "end_test",
      "Description": "测试结束",
      "Device": "system",
      "Command": "shutdown",
      "Parameters": {},
      "ExpectedResults": {},
      "TimeoutMs": 1000,
      "DependsOn": [ "generate_report" ],
      "OnSuccess": "",
      "OnFailure": ""
    }
  ]
}
